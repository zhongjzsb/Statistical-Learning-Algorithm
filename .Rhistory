control = trainControl(method = "cv"))
rdaFit <- train(Species ~ .,
data = iris,
method = "svmLinear",
control = trainControl(method = "cv"))
plot(rdaFit)
rdaFit <- train(Species ~ .,
data = iris,
method = "svmRadial",
control = trainControl(method = "cv"))
plot(rdaFit, plotType = "level")
ggplot(rdaFit) + theme_bw()
library(e1071)
data(cats, package = "MASS")
m <- svm(Sex~., data = cats)
plot(m, cats)
svmRadialFit <- train(Species ~ .,
data = iris,
method = "svmRadial",
control = trainControl(method = "cv"))
plot(svmRadialFit)
plot(svmRadialFit, plotType = "level")
library(e1071)
data(cats, package = "MASS")
m <- svm(Sex~., data = cats)
plot(m, cats)
svmRadialFit <- train(Species ~ .,
data = iris,
method = "svmRadial",
control = trainControl(method = "cv"))
plot(svmRadialFit)
ggplot(svmRadialFit) + theme_bw()
svmRadialFit$metric
plot(svmRadialFit, metric = svmRadialFit$metric)
svmRadialFit <- train(Species ~ .,
data = iris,
method = "svmRadial",
metric = "RMSE",
control = trainControl(method = "cv"))
svmRadialFit <- train(Species ~ .,
data = iris,
method = "svmRadial",
metric = "Rsquared",
control = trainControl(method = "cv"))
svmRadialFit <- train(Species ~ .,
data = iris,
method = "svmRadial",
metric = "Kappa",
control = trainControl(method = "cv"))
plot(svmRadialFit, metric = svmRadialFit$metric)
ggplot(svmRadialFit) + theme_bw()
library(caret)
data(segmentationData)
segmentationData %>%
head(10)
set.seed(100)
trainIndex <- createDataPartition(segmentationData$Class, p = .8,
list = FALSE,
times = 1)
segTrain <- segmentationData[trainIndex,]
segTest <- segmentationData[-trainIndex,]
trainX <- segTrain[,4:61]
set.seed(1000)
fitControl <- trainControl(## 10-fold CV
method = "repeatedcv",
number = 10,
## repeated five times
repeats = 5)
svmFit <- train(x = trainX,
y = segTrain$Class,
data = segTrain,
method = "svmLinear",
trControl = fitControl,
tuneLength = 15)
svmFit
segPred <- predict(svmFit, segTest[,4:61])
segPred %>%
head(10)
confusionMatrix(data = segPred, reference = segTest$Class)
postResample(pred = segPred, obs = segTest$Class)
library(e1071)
data(cats, package = "MASS")
m <- svm(Sex~., data = cats)
plot(m, cats)
svmRadialFit <- train(Species ~ .,
data = iris,
method = "svmRadial",
metric = "Kappa ",
control = trainControl(method = "cv"))
plot(svmRadialFit, metric = svmRadialFit$metric)
ggplot(svmRadialFit) + theme_bw()
## SUPPORT VECTOR MACHINE MODEL
# First pass
set.seed(1492)
# Setup for cross validation
ctrl <- trainControl(method="repeatedcv",   # 10fold cross validation
repeats=2,		    # do 2 repititions of cv
summaryFunction=twoClassSummary,	# Use AUC to pick the best model
classProbs=TRUE)
#Train and Tune the SVM
svm.tune <- train(x =trainX,
y = segTrain$Class,
method = "svmRadial",   # Radial kernel
tuneLength = 9,					# 9 values of the cost function
preProc = c("center","scale"),  # Center and scale data
metric = "ROC",
trControl = ctrl)
svm.tune
# load the package
library(kernlab)
# load data
data(longley)
# fit model
fit <- ksvm(Employed~., longley)
# summarize the fit
summary(fit)
# make predictions
predictions <- predict(fit, longley)
# summarize accuracy
rmse <- mean((longley$Employed - predictions)^2)
print(rmse)
library(e1071)
data(cats, package = "MASS")
m <- svm(Sex~., data = cats)
plot(m, cats)
svmRadialFit <- train(Species ~ .,
data = iris,
method = "svmRadial",
metric = "Kappa",
control = trainControl(method = "cv"))
plot(svmRadialFit, metric = svmRadialFit$metric)
ggplot(svmRadialFit) + theme_bw()
segmentationData
?segmentationData
library(caret)
data(segmentationData)
segmentationData %>%
head(10)
set.seed(100)
trainIndex <- createDataPartition(segmentationData$Class, p = .8,
list = FALSE,
times = 1)
segTrain <- segmentationData[trainIndex,]
segTest <- segmentationData[-trainIndex,]
trainX <- segTrain[,4:61]
set.seed(1000)
fitControl <- trainControl(## 10-fold CV
method = "repeatedcv",
number = 10,
## repeated five times
repeats = 5)
svmFit <- train(x = trainX,
y = segTrain$Class,
data = segTrain,
method = "svmLinear",
trControl = fitControl,
tuneLength = 15)
svmFit
c(0.1:1)
c(1:10)
svmFit <- train(x = trainX,
y = segTrain$Class,
data = segTrain,
method = "svmLinear",
trControl = fitControl,
tuneGrid = c(1:10)*0.1)
??tuneGrid
library(caret)
data(segmentationData)
segmentationData %>%
head(10)
set.seed(100)
trainIndex <- createDataPartition(segmentationData$Class, p = .8,
list = FALSE,
times = 1)
segTrain <- segmentationData[trainIndex,]
segTest <- segmentationData[-trainIndex,]
trainX <- segTrain[,4:61]
set.seed(1000)
fitControl <- trainControl(## 10-fold CV
method = "repeatedcv",
number = 10,
## repeated five times
repeats = 5)
svmFit <- train(x = trainX,
y = segTrain$Class,
data = segTrain,
method = "svmLinear",
trControl = fitControl)
svmFit
library(doParallel)
getModelInfo("svm")
getModelInfo("svmLinear")
svmLinearInfo %>%
glimpse()
svmLinearInfo <- getModelInfo("svmLinear")
svmLinearInfo %>%
glimpse()
svmLinearInfo <- getModelInfo("rda")
svmLinearInfo %>%
glimpse()
?getModelInfo
svmLinearInfo <- getModelInfo("rda", regex = FALSE)
svmLinearInfo %>%
glimpse()
svmLinearInfo <- getModelInfo("svmLinear", regex = FALSE)
svmLinearInfo %>%
glimpse()
svmLinearInfo[[1]] %>%
glimpse()
library(caret)
data(segmentationData)
segmentationData %>%
head(10)
set.seed(100)
trainIndex <- createDataPartition(segmentationData$Class, p = .8,
list = FALSE,
times = 1)
segTrain <- segmentationData[trainIndex,]
segTest <- segmentationData[-trainIndex,]
trainX <- segTrain[,4:61]
set.seed(1000)
fitControl <- trainControl(## 10-fold CV
method = "repeatedcv",
number = 10,
## repeated five times
repeats = 5)
rfFit <- train(x = trainX,
y = segTrain$Class,
data = segTrain,
method = "rf",
trControl = fitControl)
rfFit
fitControl <- trainControl(## 5-fold CV
method = "repeatedcv",
number = 5,
## repeated two times
repeats = 2)
rfFit <- train(x = trainX,
y = segTrain$Class,
data = segTrain,
method = "rf",
trControl = fitControl,
tuneLength = 10)
rfFit <- train(x = trainX,
y = segTrain$Class,
data = segTrain,
method = "rf",
trControl = fitControl,
tuneLength = 10)
rfFit
ggplot(rfFit) + theme_bw()
data(Sacramento)
Sacramento %>%
head(10)
set.seed(100)
trainIndex <- createDataPartition(Sacramento$speed, p = .8,
list = FALSE,
times = 1)
Sacramento %>%
head(10)
trainIndex <- createDataPartition(Sacramento$price, p = .8,
list = FALSE,
times = 1)
sacTrain <- Sacramento[trainIndex,]
sacTest <- Sacramento[-trainIndex,]
trainX <- sacTrain[,-'price']
Sacramento %>%
head(10)
trainX <- sacTrain[,-7]
trainX
set.seed(1000)
fitControl <- trainControl(## 5-fold CV
method = "repeatedcv",
number = 5,
## repeated two times
repeats = 2)
cl <- makeCluster(detectCores())
cl <- makeCluster(detectCores())
registerDoParallel(cl)
lmFit <- train(x = trainX,
y = sacTrain$Class,
data = sacTrain,
method = "lm",
trControl = fitControl,
tuneLength = 10)
cl <- makeCluster(detectCores())
cl <- makeCluster(detectCores())
registerDoParallel(cl)
lmFit <- train(x = trainX,
y = sacTrain$price,
data = sacTrain,
method = "lm",
trControl = fitControl,
tuneLength = 10)
lmFit <- train(x = trainX,
y = sacTrain$price,
data = sacTrain,
method = "lm",
trControl = fitControl)
Sacramento %>%
head(10)
trainX <- sacTrain['beds']
trainX <- sacTrain['beds', 'sqft']
sacTrain
trainX <- sacTrain['beds', 'sqft', 'baths', 'zip']
Sacramento %>%
head(10)
trainX <- sacTrain['beds', 'sqft', 'baths', 'latitude', 'longitude']
trainX <- sacTrain['beds', 'sqft', 'baths']
trainX <- sacTrain[c('beds', 'sqft', 'baths', 'latitude', 'longitude')]
trainX
data(Sacramento)
Sacramento %>%
head(10)
set.seed(100)
trainIndex <- createDataPartition(Sacramento$price, p = .8,
list = FALSE,
times = 1)
sacTrain <- Sacramento[trainIndex,]
sacTest <- Sacramento[-trainIndex,]
trainX <- sacTrain[c('beds', 'sqft', 'baths', 'latitude', 'longitude')]
set.seed(1000)
fitControl <- trainControl(## 5-fold CV
method = "repeatedcv",
number = 5,
## repeated two times
repeats = 2)
cl <- makeCluster(detectCores())
registerDoParallel(cl)
lmFit <- train(x = trainX,
y = sacTrain$price,
data = sacTrain,
method = "lm",
trControl = fitControl)
lm(sacTrain$price~trainX)
str(trainX)
str(sacTrain)
na.omit(sacTrain)
str(na.omit(sacTrain))
lm(sacTrain$price~trainX)
lm(sacTrain$price~sacTrain$beds)
getModelInfo('lm', regex = FALSE)
lmFit <- train(x = trainX$beds,
y = sacTrain$price,
data = sacTrain,
method = "lm",
trControl = fitControl)
lmFit <- train(x = trainX$beds,
y = sacTrain$price,
data = sacTrain,
method = "lm")
lmFit <- train(x = trainX$beds,
y = sacTrain$price,
data = sacTrain,
method = "lm",
metric = "RMSE",
trControl = fitControl)
lmFit <- train(x = trainX$beds,
y = sacTrain$price,
data = sacTrain,
method = "lm",
metric = "RMSE")
lmFit
lmFit <- train(x = trainX$beds,
y = sacTrain$price,
method = "lm",
metric = "RMSE")
data(Sacramento)
Sacramento %>%
head(10)
trainIndex <- createDataPartition(Sacramento$price, p = .8,
list = FALSE,
times = 1)
sacTrain <- Sacramento[trainIndex,]
trainX <- sacTrain[c('beds', 'sqft', 'baths', 'latitude', 'longitude')]
lmFit <- train(x = trainX$beds,
y = sacTrain$price,
method = "lm",
metric = "RMSE")
trainX$beds
sacTrain$price
lm(sacTrain~trainX$beds)
lm(sacTrain$price~trainX$beds)
lmFit <- train(x = trainX$beds,
y = sacTrain$price,
method = "lm",
metric = "RMSE")
sacTrain
trainX
Xs       <- matrix(rnorm(300*20), nrow = 300, ncol = 20)
Yvec     <- rnorm(300)
## Make traincontrol, cv of "none"
tcontrol <- trainControl(method = "none")
## Fit lm model using train
fit      <- train(x= Xs, y = Yvec, method = "lm", metric = "RMSE", trControl = tcontrol)
fit
lmFit <- train(x = trainX$beds,
y = sacTrain$price,
method = "lm",
metric = "RMSE")
trainX$beds
sacTrain$price
lmFit <- train(x = Sacramento$beds,
y = Sacramento$price,
method = "lm",
metric = "RMSE")
lmFit <- train(x = Sacramento$beds,
y = Sacramento$price,
method = "lm",
metric = "RMSE",
trControl = trainControl(method = "none"))
lmFit
str(Sacramento$price)
str(Sacramento$beds)
lmFit <- train(x = as.numeric(Sacramento$beds),
y = as.numeric(Sacramento$price),
method = "lm",
metric = "RMSE",
trControl = trainControl(method = "none"))
lmFit
Xs       <- matrix(rnorm(300*20), nrow = 300, ncol = 20)
Yvec     <- rnorm(300)
tcontrol <- trainControl(method = "none")
fit      <- train(x= Xs, y = Yvec, method = "lm", metric = "RMSE", trControl = tcontrol)
fit
Xs
str(Xs)
str(Yvec)
as.numeric(Sacramento$price)
fit      <- train(x= as.numeric(Sacramento$beds), y = Sacramento$price, method = "lm", metric = "RMSE", trControl = tcontrol)
str(sacTrain$price)
lmFit <- train(x = sacTrain$beds,
y = sacTrain$price,
method = "lm",
metric = "RMSE",
trControl = trainControl(method = "none"))
lmFit <- train(x = sacTrain,
y = sacTrain$price,
method = "lm",
metric = "RMSE",
trControl = trainControl(method = "none"))
lmFit
Xs       <- matrix(rnorm(300*4), nrow = 300, ncol = 4)
tcontrol <- trainControl(method = "none")
fit
Xs       <- matrix(rnorm(300*1), nrow = 300, ncol = 1)
Yvec     <- rnorm(300)
tcontrol <- trainControl(method = "none")
fit
Xs
Y
fit
fit      <- train(x= Xs, y = Yvec, method = "lm", metric = "RMSE", trControl = tcontrol)
fit
lmFit <- train(x = trainX,
y = sacTrain$price,
method = "lm",
metric = "RMSE",
trControl = trainControl(method = "none"))
lmFit
lmFit <- train(x = trainX,
y = sacTrain$price,
method = "lm",
metric = "RMSE",
trControl = fitControl)
lmFit
cl <- makeCluster(detectCores())
cl <- makeCluster(detectCores())
registerDoParallel(cl)
lmFit <- train(x = trainX,
y = sacTrain$price,
method = "lm",
metric = "RMSE",
trControl = fitControl)
lmFit
lmFit <- train(x = trainX,
y = sacTrain$price,
method = "lm",
metric = "RMSE",
trControl = fitControl)
lmFit
cl <- makeCluster(detectCores())
registerDoParallel(cl)
lmFit <- train(x = trainX,
y = sacTrain$price,
method = "lm",
metric = "RMSE",
trControl = fitControl)
lmFit
data(Sacramento)
Sacramento %>%
head(10)
set.seed(100)
trainIndex <- createDataPartition(Sacramento$price, p = .8,
list = FALSE,
times = 1)
sacTrain <- Sacramento[trainIndex,]
sacTest <- Sacramento[-trainIndex,]
trainX <- sacTrain[c('beds', 'sqft', 'baths', 'latitude', 'longitude')]
set.seed(1000)
fitControl <- trainControl(## 5-fold CV
method = "repeatedcv",
number = 5,
## repeated two times
repeats = 2)
lmFit <- train(x = trainX,
y = sacTrain$price,
method = "lm",
metric = "RMSE",
trControl = fitControl)
lmFit
